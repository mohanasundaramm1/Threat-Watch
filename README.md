<div align="center">
  <img src="https://img.shields.io/badge/Status-Ready_to_Demo-success?style=for-the-badge" alt="Status" />
  <h1>üõ°Ô∏è ThreatWatch</h1>
  <h3>Intelligent Threat Intelligence & MLOps Platform</h3>
  <p>An enterprise-grade Data Engineering and Machine Learning platform detecting, classifying, and visualizing zero-day cyber threats natively.</p>
</div>

---

## üë• Meet the Team
**Kingston University - Capstone Project 2025/2026**
- **Mohan (vw4192)** ‚Äì Data Engineering & Architecture
- **Nikita (kf3051)** ‚Äì Machine Learning & Frontend Dashboard

---

## üåü Project Highlights

ThreatWatch is a complete end-to-end Big Data & MLOps pipeline. It ingests thousands of daily threats from global OSINT feeds, enriches them with topological WHOIS/DNS data, predicts their exact risk utilizing a custom LightGBM model, and surfaces everything onto a live React dashboard.

- **Zero-Day MISP Firewall:** Cross-references incoming domains against 8,000+ daily MISP indicators.
- **Infrastructure Overlap Engine:** Employs fuzzy-matching to flag entirely new domains if they map to IPs heavily correlated with known MISP attacks.
- **Continuous ML Training:** A fully automated Apache Airflow orchestration pipeline running a `biweekly_ml_retraining` DAG to automatically retrain the LightGBM models against drifting data.
- **Next.js Real-time Dashboard:** A high-end analytics platform mapping top threat global geographies dynamically via `react-simple-maps`.

---

## üèóÔ∏è System Architecture 

The data lifecycle follows a strict **Medallion Architecture**, orchestrated by Apache Airflow.

```mermaid
graph TD
    subgraph External Sources
        OP[OpenPhish API]
        UH[URLHaus API]
        MISP[MISP Threat Sharing]
    end

    subgraph Bronze Layer [Raw Ingestion]
        B_OP[(Bronze: OpenPhish)]
        B_UH[(Bronze: URLHaus)]
        B_MISP[(Bronze: MISP Indicators)]
    end

    subgraph Silver Layer [Cleansed & Enriched]
        S_L[(Silver: Labels Union)]
        S_OS[(Silver: MISP OSINT)]
        L_DNS[(Lookups: DNS/Geo)]
        L_WHO[(Lookups: WHOIS)]
    end

    subgraph Gold Layer / MLOps [Predictions & Serving]
        ML_T[LightGBM Retraining Pipeline]
        ML_P[Inference/Prediction Pipeline]
        D_JSON[(Dashboard Data JSONs)]
    end

    subgraph Frontend [Next.js App]
        UI[ThreatWatch UI & Analytics Map]
    end

    OP --> B_OP
    UH --> B_UH
    MISP --> B_MISP

    B_OP & B_UH --> S_L
    B_MISP --> S_OS

    S_L --> L_DNS & L_WHO
    
    L_DNS & L_WHO & S_OS & S_L --> ML_T
    L_DNS & L_WHO & S_OS & S_L --> ML_P

    ML_T -.->|Registers Model| ML_P
    ML_P -->|Exports| D_JSON
    D_JSON --> UI
```

---

## üöÄ Quick Start Guide

### 1. Start the Data Engineering Backend
We utilize Docker Compose to spin up the Apache Airflow orchestrator and its PostgreSQL meta-database.
```bash
cd threat-intel
docker-compose -f docker-compose.airflow.yml up -d
```
*Wait ~2 minutes for the containers to fully initialize.*

Once active, trigger the data pipelines manually or wait for the 2-hour scheduler:
- Access the Airflow UI at `http://localhost:8080` (Default login: `airflow` / `airflow`).
- Enable the `pipeline_orchestrator` and `two_hourly_prediction` DAGs.

### 2. Start the ThreatWatch Dashboard
The frontend is a lightweight Next.js application that natively reads the exported `/data` JSON files generated by the Airflow backend.
```bash
cd dashboard
npm install
npm run dev
```

### 3. View the Application
Navigate to `http://localhost:3000` to view the live threat matrix.

---

## üß¨ Core Technologies Stack

### **Data Engineering & Orchestration**
- **Apache Airflow:** Scheduling, dependency management, and workflow orchestration.
- **Apache Parquet:** Columnar storage format for high-speed read/write in the Data Lake.
- **Docker:** Containerized execution environment ensuring parity.

### **Machine Learning & Analytics**
- **LightGBM:** Gradient boosting framework chosen for its highly optimized speed and accuracy on topological data.
- **Scikit-Learn:** Feature hashing, data imputation, and logistic regression baselines.
- **Pandas / SciPy:** Memory mapped data manipulations.

### **Frontend Interface**
- **Next.js 14 / React:** Server-side rendered interface for instant data loading.
- **Tailwind CSS:** Utility-first styling for modern UI metrics.
- **React Simple Maps:** SVG-based interactive chloropleth data mapping.

---

## ÔøΩ ML Model Performance
Our dynamic LightGBM engine currently validates with incredibly resilient metrics against live drifting data:
- **ROC-AUC Score:** `98.44%`
- **Precision-Recall AUC:** `98.26%`
- **Recall at 1% FPR:** `89.80%`
*Note: These metrics dynamically update bi-weekly upon Airflow's automatic retraining triggers.*

---

<div align="center">
  <i>Developed for the 2025/2026 Kingston University Data Engineering Capstone.</i>
</div>
